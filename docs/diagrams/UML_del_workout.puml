
@startuml
title FitChasers â€“ Sequence Diagram for "/del_workout"

skinparam shadowing false
skinparam responseMessageBelowArrow true
skinparam sequence {
  ArrowColor #444
  LifeLineBorderColor #444
  LifeLineBackgroundColor #FAFAFA
  ParticipantBorderColor #222
  ParticipantBackgroundColor #F7F7F7
  BoxBorderColor #AAA
  BoxBackgroundColor #FFF
  NoteBorderColor #AAA
  NoteBackgroundColor #FFF
}

actor User
boundary UI as "UI"
control FitChasers as "FitChasers (main loop)"
control VL as "ViewLog"
control WM as "WorkoutManager"
database FH as "FileHandler"

== User enters command ==
User -> UI : enter "/del_workout -m 10 5"\n(or: "/del_workout Push Day")
UI -> FitChasers : readCommand()
activate FitChasers

FitChasers -> FitChasers : delMethod(args)
activate WM #white

alt Month + Index form: "-m <MM> <index>"
  FitChasers -> VL : parseArgs(args)
  VL --> FitChasers : {ym, extractedArg=index}

  ' load the month file and switch WM's working set
  FitChasers -> FH : loadMonthList(ym)
  FH --> FitChasers : workoutsForMonth
  FitChasers -> WM : setWorkouts(workoutsForMonth, ym)

  ' ask WM to delete by index
  FitChasers -> WM : deleteWorkoutByIndex(index)
  activate WM
  alt Invalid index
    WM -> UI : showMessage("Invalid workout index ...")
    deactivate WM
  else Valid index
    WM -> UI : showMessage("You sure you want to delete this? (y/n)")
    UI -> WM : confirmationMessage()
    alt User confirms
      WM -> WM : remove workout from list
      WM -> FH : saveMonthList(currentLoadedMonth, workouts)
      FH --> WM : ok
      WM -> UI : showMessage("Deleted workout: <name>")
    else User cancels
      WM -> UI : showMessage("Okay, deletion aborted.")
    end
    deactivate WM
  end

else Name form: "/del_workout <name>"
  FitChasers -> WM : deleteWorkout(name)
  activate WM
  alt Name found
    WM -> UI : showMessage("Deleting <name> | <date> ? (Type Y to confirm)")
    UI -> WM : confirmationMessage()
    alt User confirms
      WM -> WM : remove workout
      WM -> FH : saveMonthList(currentLoadedMonth, workouts)
      FH --> WM : ok
      WM -> UI : showMessage("Workout deleted successfully!")
    else User cancels
      WM -> UI : showMessage("Okay, I didn't delete it.")
    end
  else Name not found
    WM -> UI : showMessage("Workout not found: <name>")
  end
  deactivate WM
end

deactivate FitChasers

' Optional: UI shows final status to User
UI --> User : show deletion message

@enduml
